<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8">
    
    <title>&lt;no title&gt; &mdash; fem  documentation</title>
    
    <link rel="stylesheet" type="text/css" href="../../../_static/css/spc-bootstrap.css">
    <link rel="stylesheet" type="text/css" href="../../../_static/css/spc-extend.css">
    <link rel="stylesheet" href="../../../_static/scipy.css" type="text/css" >
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" >
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../../../_static/js/copybutton.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" >
    <link rel="search" title="Search" href="../../../search.html" >
    <link rel="top" title="fem  documentation" href="../../../index.html" > 
  </head>
  <body>

  <div class="container">
    <div class="header">
    </div>
  </div>


    <div class="container">
      <div class="main">
        
	<div class="row-fluid">
	  <div class="span12">
	    <div class="spc-navbar">
              
    <ul class="nav nav-pills pull-left">
        <li class="active"><a href="https://www.niddk.nih.gov/research-funding/at-niddk/labs-branches/LBM">LBM</a></li>
        <li class="active"><a href="https://pypi.python.org/pypi/fem">fem</a></li>
	
        <li class="active"><a href="../../../index.html">fem  documentation</a></li>
	 
    </ul>
              
              
    <ul class="nav nav-pills pull-right">
      <li class="active">
        <a href="../../../genindex.html" title="General Index"
           accesskey="I">index</a>
      </li>
      <li class="active">
        <a href="../../../f-modindex.html" title="Fortran Module Index"
           >fortran modules</a>
      </li>
      <li class="active">
        <a href="../../../py-modindex.html" title="Python Module Index"
           >modules</a>
      </li>
    </ul>
              
	    </div>
	  </div>
	</div>
        

	<div class="row-fluid">
      <div class="spc-rightsidebar span3">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
          <div class="span9">
            
        <div class="bodywrapper">
          <div class="body" id="spc-section-body">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput div.prompt,
div.nbinput div.input_area,
div.nbinput div[class*=highlight],
div.nbinput div[class*=highlight] pre,
div.nboutput,
div.nbinput div.prompt,
div.nbinput div.output_area,
div.nboutput div[class*=highlight],
div.nboutput div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput,
    div.nboutput {
        flex-direction: column;
    }
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput div.prompt pre {
    color: #303F9F;
}

/* output prompt */
div.nboutput div.prompt pre {
    color: #D84315;
}

/* all prompts */
div.nbinput div.prompt,
div.nboutput div.prompt {
    min-width: 9ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput div.prompt,
    div.nboutput div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput div.prompt pre,
div.nboutput div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput div.input_area,
div.nboutput div.output_area {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput div.input_area,
    div.nboutput div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput div.input_area {
    border: 1px solid #cfcfcf;
    border-radius: 2px;
    background: #f7f7f7;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.pngmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }
</style>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [1]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span>from scipy.linalg import solve
from scipy.special import erf as erf
import matplotlib.pyplot as plt
import numpy as np
import pandas as pd
import multiprocessing as mp
import os, pickle
import sklearn
from sklearn.metrics import auc as sklearn_auc
data_dir = &#39;../../../../data/vim2/&#39;
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [2]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span># max number of st/00 st/01 .. chunks to use
max_i = 9
# person
subject = 1
# seconds offset between movie and brain data
lag = 1
# maximum number of voxels to use
max_voxels = 100
# fraction of data that is training
train_frac = 0.8
train_folds = 4
train_fold = 1

object_to_infer = &#39;person&#39;

# load movie data
movie_data = [&#39;&#39; for _ in range(max_i)]
for i in range(max_i):
    objects_file = os.path.join(data_dir, &#39;st&#39;, &#39;%02i_objects_py2.pkl&#39; % (i, ))
    with open(objects_file, &#39;rb&#39;) as f:
        movie_data[i] = pickle.load(f)

objects = [d for l in movie_data for d in l]
unique_objects = np.unique([k for d in objects for k in d])

n_frames = len(objects)
n_unique_objects = unique_objects.shape[0]
object_index = dict(zip(unique_objects, range(n_unique_objects)))

confidence = np.zeros((n_unique_objects, n_frames))
for frame, d in enumerate(objects):
    for o, c in d.iteritems():
        confidence[object_index[o], frame] = c
barcode = ~np.isclose(confidence, 0)

order = np.argsort(barcode.sum(1))[::-1]
confidence = confidence[order]
barcode = barcode[order]
unique_objects = unique_objects[order]
object_index = dict(zip(unique_objects, range(n_unique_objects)))

objects_to_infer_idx = [object_index[o] for o in objects_to_infer]


# load brain data
brain_data = [
    np.load(
        os.path.join(data_dir, &#39;subject_%i&#39; % (subject, ), &#39;rt&#39;, &#39;%02i.npy&#39; % (
            i, ))) for i in range(max_i)
]
brain_data = np.hstack(brain_data)
complete_vox = np.isclose(np.isnan(brain_data).sum(1), 0)
brain_data = brain_data[complete_vox]

vox_idx = np.random.choice(brain_data.shape[0],
                           size=min(brain_data.shape[0], max_voxels),
                           replace=False)
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [3]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span>objects_data = confidence[objects_to_infer_idx]
objects_data = np.stack([o.mean(1) for o in np.split(objects_data, n_frames / 15, axis=1)]).T
objects_data = np.roll(objects_data, lag)

brain_data = brain_data[vox_idx]

x = np.vstack((objects_data, brain_data))
t = range(x.shape[1])
x = x[:, lag:]
t = t[lag:]

x -= x.mean(1)[:,np.newaxis]

split = int(x.shape[1] * train_frac)
x_train, x_test = x[:, :split], x[:, split:]
t_train, t_test = t[:split], t[split:]

x_train1, x_train2 = x_train[:, :-1], x_train[:, 1:]
t_train1, t_train2 = t_train[:-1], t_train[1:]

x_test1, x_test2 = x_test[:, :-1], x_test[:, 1:]
t_test1, t_test2 = t_test[:-1], t_test[1:]
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [4]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span>fig = plt.figure(figsize=(14,12))
ax = plt.gca()
ax.imshow(barcode, cmap=&#39;Greys&#39;, aspect=&#39;auto&#39;)
ax.set_yticks(range(n_unique_objects))
ax.set_yticklabels(unique_objects)
ax.set_xlabel(&#39;frame&#39;)
plt.show()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/notebooks_continuous_drafts_chair_fit_3_0.png" src="../../../_images/notebooks_continuous_drafts_chair_fit_3_0.png" />
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [5]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span># n, T = 20, int(1e4)
n, tn = x_train.shape
dt = 1.
l = np.int(np.ceil(tn / dt))
sqrt_dt = np.sqrt(dt)
sqrt_2 = np.sqrt(2)
rat = sqrt_dt / sqrt_2

sign_dx = np.sign(np.diff(x_train))
mean_x = x_train.mean(1)
cov_x = np.cov(x_train)
x_train1_mean0 = x_train1 - mean_x[:, np.newaxis]


def fit(i, iters=100):

    wi = np.zeros(n)
    wi[i] = 1

    # erf_last = erf(x1[i] * rat) + 1
    erf_last = erf(x_train1[i]) + 1

    e = []

    for it in range(iters):

        h = wi.dot(x_train1)

        erf_next = erf(h)
        ei = np.linalg.norm(erf_next - erf_last)
        e.append(ei)
        if ei * ei &lt; 1e-8:
            break
        erf_last = erf_next.copy()

        h *= -sign_dx[i] / erf_next

        wi = solve(cov_x, x_train1_mean0.dot(h) / (l - 1))

    return wi, e[1:]

def predict(i, x):
    return x[i] + w[i, n_objects_to_infer:].dot(x[n_objects_to_infer:])

pool = mp.Pool(processes=mp.cpu_count())
res = pool.map(fit, range(n_objects_to_infer))
pool.close()
pool.terminate()
pool.join()
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [6]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span>w = np.empty((n_objects_to_infer, n))
w = np.vstack([r[0] for r in res]) / rat
e = [r[1] for r in res]

fig = plt.figure(figsize=(3,3))
ax = plt.gca()
for ei in e:
    ax.plot(ei, &#39;k-&#39;)
plt.show()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/notebooks_continuous_drafts_chair_fit_5_0.png" src="../../../_images/notebooks_continuous_drafts_chair_fit_5_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [7]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span>x_train2_prediction = np.vstack([predict(i, x_train1) for i in range(n_objects_to_infer)])
x_test2_prediction = np.vstack([predict(i, x_test1) for i in range(n_objects_to_infer)])

x_train2_prediction -= x_train2_prediction.mean(1)[:, np.newaxis]
x_train2_prediction /= x_train2_prediction.max(1)[:, np.newaxis]
x_train2_prediction[x_train2_prediction &lt; 0] = 0

x_test2_prediction -= x_test2_prediction.mean(1)[:, np.newaxis]
x_test2_prediction /= x_test2_prediction.max(1)[:, np.newaxis]
x_test2_prediction[x_test2_prediction &lt; 0] = 0

x[:n_objects_to_infer] -= x[:n_objects_to_infer].min(1)[:,np.newaxis]
x[:n_objects_to_infer] /= x[:n_objects_to_infer].max(1)[:,np.newaxis]

fig, ax = plt.subplots(n_objects_to_infer, 1, figsize=(14, n_objects_to_infer))
for i in range(n_objects_to_infer):
    ax[i].plot(t_train2, x_train2_prediction[i], &#39;b-&#39;, t_test2, x_test2_prediction[i], &#39;r-&#39;, alpha=0.5)
    ax[i].plot(t, x[i], &#39;k-&#39;, alpha=0.5)
    ax[i].set_ylabel(objects_to_infer[i])
plt.show()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/notebooks_continuous_drafts_chair_fit_6_0.png" src="../../../_images/notebooks_continuous_drafts_chair_fit_6_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [8]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span>def roc(x, x_prediction, threshold=0.5, n_threshold=500):

    tpr = np.empty((n_objects_to_infer, n_threshold))
    fpr = np.empty((n_objects_to_infer, n_threshold))

    for i, thr in enumerate(np.linspace(0, 1, n_threshold)):

        positives = x &gt; threshold
        negatives = ~positives

        predicted_positives = x_prediction &gt;= thr
        predicted_negatives = ~predicted_positives

        true_positives = positives &amp; predicted_positives
        false_positives = negatives &amp; predicted_positives

        true_negatives = negatives &amp; predicted_negatives
        false_negatives = negatives &amp; predicted_positives

        tpr[:,i] = true_positives.sum(1) / positives.sum(1).astype(float)
        fpr[:,i] = false_positives.sum(1) / negatives.sum(1).astype(float)

    auc = np.array([sklearn_auc(fpr[i], tpr[i]) for i in range(n_objects_to_infer)])

    return fpr, tpr, auc

fig, ax = plt.subplots(1, 3, figsize=(15, 5))

train_fpr, train_tpr, train_auc = roc(x_train2[:n_objects_to_infer], x_train2_prediction)
ax[0].plot(train_fpr.T, train_tpr.T)
test_fpr, test_tpr, test_auc = roc(x_test2[:n_objects_to_infer], x_test2_prediction)
ax[1].plot(test_fpr.T, test_tpr.T)
for i in range(n_objects_to_infer):
    ax[2].scatter(train_auc[i], test_auc[i], label=objects_to_infer[i])

ax[0].set_title(&#39;training&#39;)
ax[1].set_title(&#39;testing&#39;)
for a in ax[:2]:
    a.set_ylabel(&#39;true positive rate&#39;)
    a.set_xlabel(&#39;false positive rate&#39;)
ax[2].set_xlabel(&#39;training ROC AUC&#39;)
ax[2].set_ylabel(&#39;testing ROC AUC&#39;)

plt.tight_layout()
plt.show()
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="stderr output_area docutils container">
<div class="highlight"><pre>
/usr/lib/python2.7/site-packages/ipykernel_launcher.py:20: RuntimeWarning: invalid value encountered in divide
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/notebooks_continuous_drafts_chair_fit_7_1.png" src="../../../_images/notebooks_continuous_drafts_chair_fit_7_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [9]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span>data = np.stack((train_auc, test_auc))
pd.DataFrame(index=objects_to_infer, data=data.T, columns=[&#39;train AUC&#39;, &#39;test AUC&#39;])
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[9]:
</pre></div>
</div>
<div class="output_area docutils container">
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>train AUC</th>
      <th>test AUC</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>banana</th>
      <td>0.828691</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>train</th>
      <td>0.852044</td>
      <td>0.956681</td>
    </tr>
    <tr>
      <th>orange</th>
      <td>0.862561</td>
      <td>0.944444</td>
    </tr>
    <tr>
      <th>couch</th>
      <td>0.701029</td>
      <td>0.809931</td>
    </tr>
    <tr>
      <th>donut</th>
      <td>0.825353</td>
      <td>0.768055</td>
    </tr>
    <tr>
      <th>surfboard</th>
      <td>0.547766</td>
      <td>0.825800</td>
    </tr>
    <tr>
      <th>traffic light</th>
      <td>0.850615</td>
      <td>0.769124</td>
    </tr>
    <tr>
      <th>knife</th>
      <td>0.681230</td>
      <td>0.245828</td>
    </tr>
    <tr>
      <th>dog</th>
      <td>0.844016</td>
      <td>0.791725</td>
    </tr>
    <tr>
      <th>vase</th>
      <td>0.894424</td>
      <td>0.990264</td>
    </tr>
    <tr>
      <th>hot dog</th>
      <td>0.910581</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>zebra</th>
      <td>0.933554</td>
      <td>0.955649</td>
    </tr>
    <tr>
      <th>bed</th>
      <td>0.796365</td>
      <td>0.821445</td>
    </tr>
    <tr>
      <th>skis</th>
      <td>0.743602</td>
      <td>0.943324</td>
    </tr>
    <tr>
      <th>airplane</th>
      <td>0.923711</td>
      <td>0.856214</td>
    </tr>
    <tr>
      <th>tennis racket</th>
      <td>0.502954</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>potted plant</th>
      <td>0.899894</td>
      <td>0.903225</td>
    </tr>
    <tr>
      <th>bicycle</th>
      <td>0.514924</td>
      <td>0.254868</td>
    </tr>
    <tr>
      <th>motorcycle</th>
      <td>0.970192</td>
      <td>0.255563</td>
    </tr>
    <tr>
      <th>cow</th>
      <td>0.902163</td>
      <td>0.940849</td>
    </tr>
    <tr>
      <th>clock</th>
      <td>0.769934</td>
      <td>0.807531</td>
    </tr>
    <tr>
      <th>backpack</th>
      <td>0.758532</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>cake</th>
      <td>0.841832</td>
      <td>0.990947</td>
    </tr>
    <tr>
      <th>tie</th>
      <td>0.720980</td>
      <td>0.867354</td>
    </tr>
    <tr>
      <th>frisbee</th>
      <td>0.753287</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>refrigerator</th>
      <td>NaN</td>
      <td>0.673050</td>
    </tr>
    <tr>
      <th>laptop</th>
      <td>0.669573</td>
      <td>0.627349</td>
    </tr>
    <tr>
      <th>fire hydrant</th>
      <td>0.888048</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>spoon</th>
      <td>0.563712</td>
      <td>0.689183</td>
    </tr>
    <tr>
      <th>kite</th>
      <td>0.852332</td>
      <td>0.941880</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>bench</th>
      <td>NaN</td>
      <td>0.910017</td>
    </tr>
    <tr>
      <th>carrot</th>
      <td>0.963167</td>
      <td>0.989554</td>
    </tr>
    <tr>
      <th>elephant</th>
      <td>0.888967</td>
      <td>0.994437</td>
    </tr>
    <tr>
      <th>boat</th>
      <td>0.816132</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>wine glass</th>
      <td>0.700637</td>
      <td>0.983352</td>
    </tr>
    <tr>
      <th>bear</th>
      <td>0.908229</td>
      <td>0.999305</td>
    </tr>
    <tr>
      <th>microwave</th>
      <td>0.258773</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>toilet</th>
      <td>0.871548</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>apple</th>
      <td>0.846611</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>umbrella</th>
      <td>0.873476</td>
      <td>0.876541</td>
    </tr>
    <tr>
      <th>sports ball</th>
      <td>NaN</td>
      <td>0.876832</td>
    </tr>
    <tr>
      <th>handbag</th>
      <td>0.802290</td>
      <td>0.770877</td>
    </tr>
    <tr>
      <th>hair drier</th>
      <td>0.452788</td>
      <td>0.253477</td>
    </tr>
    <tr>
      <th>dining table</th>
      <td>0.611637</td>
      <td>0.695846</td>
    </tr>
    <tr>
      <th>baseball bat</th>
      <td>0.832193</td>
      <td>0.992350</td>
    </tr>
    <tr>
      <th>chair</th>
      <td>0.678552</td>
      <td>0.823989</td>
    </tr>
    <tr>
      <th>truck</th>
      <td>0.644769</td>
      <td>0.549722</td>
    </tr>
    <tr>
      <th>toaster</th>
      <td>0.255862</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>toothbrush</th>
      <td>0.477074</td>
      <td>0.652295</td>
    </tr>
    <tr>
      <th>teddy bear</th>
      <td>0.951970</td>
      <td>0.997387</td>
    </tr>
    <tr>
      <th>car</th>
      <td>0.848383</td>
      <td>0.871938</td>
    </tr>
    <tr>
      <th>broccoli</th>
      <td>0.840098</td>
      <td>0.997213</td>
    </tr>
    <tr>
      <th>mouse</th>
      <td>0.986987</td>
      <td>0.820584</td>
    </tr>
    <tr>
      <th>oven</th>
      <td>0.770878</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>cell phone</th>
      <td>0.872924</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>remote</th>
      <td>0.942410</td>
      <td>0.983658</td>
    </tr>
    <tr>
      <th>sink</th>
      <td>0.581080</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>horse</th>
      <td>0.911227</td>
      <td>0.629610</td>
    </tr>
    <tr>
      <th>bus</th>
      <td>0.819912</td>
      <td>0.870706</td>
    </tr>
    <tr>
      <th>bottle</th>
      <td>0.892208</td>
      <td>0.992266</td>
    </tr>
  </tbody>
</table>
<p>80 rows Ã— 2 columns</p>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [10]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span>plt.imshow(w[:80,:80], cmap=&#39;seismic&#39;, vmin=-1, vmax=1)
plt.show()
w[:80,:80].min(), w[:80,:80].max()
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/notebooks_continuous_drafts_chair_fit_9_0.png" src="../../../_images/notebooks_continuous_drafts_chair_fit_9_0.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[10]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>(-174.8725029019912, 75.17526315270185)
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [11]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span>[unique_objects[i] for i in np.squeeze(np.argwhere(np.isclose((confidence &gt; 0.5).sum(1), 0)))]
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[11]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>[u&#39;dining table&#39;, u&#39;hair drier&#39;, u&#39;toaster&#39;]
</pre></div>
</div>
</div>


          </div>
        </div>
          </div>
        </div>
      </div>
    </div>

    <div class="container container-navbar-bottom">
      <div class="spc-navbar">
        
      </div>
    </div>
    <div class="container">
    <div class="footer">
    <div class="row-fluid">
    <ul class="inline pull-left">
      <li>
        &copy; Copyright 2018, Joe McKenna.
      </li>
      <li>
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.7.9.
      </li>
    </ul>
    </div>
    </div>
    </div>
  </body>
</html>